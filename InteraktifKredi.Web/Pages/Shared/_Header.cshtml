@* Header Partial View - İnteraktif Kredi Web Şube *@
@{
    var isAuthenticated = Context.Session.GetString("CustomerId") != null;
    var customerId = Context.Session.GetString("CustomerId");
    var userName = Context.Session.GetString("UserName") ?? "Kullanıcı";
    var currentPage = ViewContext.RouteData.Values["page"]?.ToString() ?? "";
    
    // Aktif sayfa tespiti için helper function
    Func<string, bool> IsActivePage = (pagePath) => {
        if (string.IsNullOrEmpty(currentPage)) return false;
        return currentPage.Equals(pagePath, StringComparison.OrdinalIgnoreCase) ||
               currentPage.StartsWith(pagePath, StringComparison.OrdinalIgnoreCase);
    };
    
    // Sayfa aktif state kontrolü
    var isDashboardActive = IsActivePage("/Dashboard") || IsActivePage("/Index") || currentPage == "/";
    var isLoanActive = IsActivePage("/Loan");
    var isAccountActive = IsActivePage("/Account");
    var isAuthActive = IsActivePage("/Auth/Login") || IsActivePage("/Auth/OtpVerify");
    var isHelpActive = IsActivePage("/FAQ");
}

<header class="header">
    <div class="header__container">
        @* Logo Section *@
        <a href="/Dashboard" class="header__logo" aria-label="İnteraktif Kredi Ana Sayfa">
            @* Logo görseli buraya eklenecek - şimdilik text logo *@
            <span class="header__logo_text">İnteraktif Şube</span>
        </a>

        @if (isAuthenticated)
        {
            @* Navigation Menu *@
            <nav class="header__nav" id="header_nav" aria-label="Ana Navigasyon">
                <ul class="header__nav_list">
                    @* Kullanıcı Anasayfası (Dashboard) - Dropdown *@
                    <li class="header__nav_item header__nav_item--dropdown">
                        <a href="/Dashboard" 
                           class="header__nav_link"
                           aria-label="Ana Ekran"
                           id="dashboard_menu_toggle">
                            <svg class="header__nav_link_icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                                <polyline points="9 22 9 12 15 12 15 22"></polyline>
                            </svg>
                            <span>Ana Ekran</span>
                            <svg class="header__nav_link_arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </a>
                        <ul class="header__nav_dropdown" id="dashboard_dropdown">
                            <li class="header__nav_dropdown_item">
                                <a href="/Dashboard/Reports" class="header__nav_dropdown_link">Rapor Detayları</a>
                            </li>
                            <li class="header__nav_dropdown_item">
                                <a href="/Dashboard/Invoices" class="header__nav_dropdown_link">Faturalar</a>
                            </li>
                            <li class="header__nav_dropdown_item">
                                <a href="/Dashboard/LoanOffers" class="header__nav_dropdown_link">Kredi Teklifleri (Kişiye Özel)</a>
                            </li>
                        </ul>
                    </li>
                    
                    @* Yardım & Destek Merkezi *@
                    <li class="header__nav_item">
                        <a href="/FAQ" 
                           class="header__nav_link"
                           aria-label="Yardım & Destek">
                            <svg class="header__nav_link_icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                                <line x1="12" y1="17" x2="12.01" y2="17"></line>
                            </svg>
                            <span>Yardım & Destek</span>
                        </a>
                    </li>
                </ul>
            </nav>

            @* User Section *@
            <div class="header__user">
                <div class="header__user_info" id="user_menu_toggle">
                    <div class="header__user_avatar">
                        @userName.Substring(0, 1).ToUpper()
                    </div>
                    <span class="header__user_name">@userName</span>
                </div>
                <div class="header__user_menu">
                    <div class="header__user_dropdown" id="user_dropdown">
                        <div class="header__user_dropdown_section">
                            <div class="header__user_dropdown_title">Profil & Hesap Ayarları</div>
                            <a href="/Account/Profile" class="header__user_dropdown_item">
                                Profil Ayarları
                            </a>
                            <a href="/Account/Address" class="header__user_dropdown_item">
                                Adres / İletişim Bilgileri
                            </a>
                            <a href="/Account/JobIncome" class="header__user_dropdown_item">
                                Meslek & Gelir Bilgileri
                            </a>
                        </div>
                        <div class="header__user_dropdown_divider"></div>
                        <a href="/Auth/Logout" class="header__user_dropdown_item header__user_dropdown_item--danger">
                            Çıkış Yap
                        </a>
                    </div>
                </div>
            </div>

            @* Mobile Menu Toggle (Hamburger) *@
            <button class="header__toggle" id="header_toggle" aria-label="Menüyü Aç/Kapat" aria-expanded="false">
                <span class="header__toggle_line"></span>
                <span class="header__toggle_line"></span>
                <span class="header__toggle_line"></span>
            </button>
        }
        else
        {
            @* Giriş yapmamış kullanıcılar için sadece logo göster *@
            <div class="header__user">
                <a href="/Auth/Login" class="btn_primary btn_primary--auto btn_primary--sm">Giriş Yap</a>
            </div>
        }
    </div>

    @* Mobile Menu Overlay *@
    <div class="header__overlay" id="header_overlay"></div>
</header>
