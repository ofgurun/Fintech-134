@page
@model InteraktifKredi.Web.Pages.Dashboard.IndexModel
@{
    ViewData["Title"] = "Ana Men√º";
    Layout = "_DashboardLayout";
}

<!-- KVKK Modal Kontrol√º - Layout dƒ±≈üƒ±nda -->
@if (Model.ShowKvkk)
{
    <!-- KVKK Modal (Full screen overlay) -->
    <script>
        // Global fonksiyon - inline onclick i√ßin
        function approveKvkk() {
            var $btn = $('#btn-approve-kvkk');
            var kvkkId = @Model.KvkkId;
            var customerId = @Model.CustomerId;
            
            console.log('üîµ KVKK Onay butonu tƒ±klandƒ±', { kvkkId, customerId });
            
            $btn.prop('disabled', true).text('Kaydediliyor...');
            
            $.ajax({
                url: '/Dashboard/Index?handler=ApproveKvkk',
                type: 'POST',
                contentType: 'application/json',
                headers: {
                    'RequestVerificationToken': $('input[name="__RequestVerificationToken"]').val()
                },
                data: JSON.stringify({
                    kvkkId: kvkkId,
                    customerId: customerId
                }),
                success: function(response) {
                    console.log('‚úÖ KVKK onay response:', response);
                    
                    if (response && response.success === true) {
                        console.log('‚úÖ KVKK onaylandƒ±, modal kapatƒ±lƒ±yor...');
                        
                        // Modal'ƒ± kapat
                        $('#kvkkModal').fadeOut(300, function() {
                            $(this).remove();
                        });
                        
                        // Blur'u kaldƒ±r
                        $('.dashboard_sidebar, .dashboard_main').css({
                            'filter': 'none',
                            'pointer-events': 'auto'
                        });
                        
                        console.log('‚úÖ Dashboard aktif!');
                    } else {
                        console.error('‚ùå KVKK onayƒ± ba≈üarƒ±sƒ±z:', response);
                        alert('KVKK onayƒ± kaydedilemedi. L√ºtfen tekrar deneyin.');
                        $btn.prop('disabled', false).text('Okudum, Onaylƒ±yorum');
                    }
                },
                error: function(xhr, status, error) {
                    console.error('‚ùå AJAX hatasƒ±:', { status, error, response: xhr.responseText });
                    alert('Bir hata olu≈ütu. L√ºtfen sayfayƒ± yenileyip tekrar deneyin.');
                    $btn.prop('disabled', false).text('Okudum, Onaylƒ±yorum');
                }
            });
            
            return false; // Form submit'i engelle
        }
        
        // DOM hazƒ±r olunca blur uygula
        $(document).ready(function() {
            $('.dashboard_sidebar, .dashboard_main').css({
                'filter': 'blur(5px)',
                'pointer-events': 'none'
            });
            console.log('‚úÖ KVKK Modal aktif - Dashboard blur edildi');
        });
    </script>
    
    <!-- KVKK Modal HTML -->
    <div id="kvkkModal" class="modal-overlay active" style="position: fixed; z-index: 10000; top: 0; left: 0; width: 100%; height: 100%;">
        <div class="modal-container">
            <div class="modal-header">
                <h3>Aydƒ±nlatma Metni</h3>
            </div>
            <div class="modal-body" id="kvkk-content">
                @Html.Raw(Model.KvkkTextContent ?? "Metin y√ºkleniyor...")
            </div>
            <div class="modal-footer">
                @Html.AntiForgeryToken()
                <button type="button" class="btn_primary" id="btn-approve-kvkk" onclick="approveKvkk(); return false;">
                    Okudum, Onaylƒ±yorum
                </button>
            </div>
        </div>
    </div>
}

<!-- ========================================================================
     ANA DASHBOARD - Bƒ∞LGƒ∞LENDƒ∞RME ODAKLI SAYFA
======================================================================== -->
<div class="dashboard_page">
    
    <!-- ========================================================================
         Vƒ∞ZYON KARTI (Hero Section)
    ========================================================================= -->
    <section class="dashboard_hero_section">
        <div class="dashboard_hero_content">
            <div class="dashboard_hero_icon">
                <svg width="64" height="64" viewBox="0 0 64 64" fill="none">
                    <circle cx="32" cy="32" r="32" fill="url(#gradient-primary)"/>
                    <path d="M20 32L28 40L44 24" stroke="white" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
                    <defs>
                        <linearGradient id="gradient-primary" x1="0" y1="0" x2="64" y2="64" gradientUnits="userSpaceOnUse">
                            <stop stop-color="#0055FF"/>
                            <stop offset="1" stop-color="#3D7EFF"/>
                        </linearGradient>
                    </defs>
                </svg>
            </div>
            <h1 class="dashboard_hero_title">ƒ∞nteraktif Kredi'ye Ho≈ü Geldiniz</h1>
            <p class="dashboard_hero_subtitle">
                Hƒ±z, ≈üeffaflƒ±k ve g√ºven odaklƒ± finansal √ß√∂z√ºmlerle geleceƒüinizi ≈üekillendirin. 
                Kredi ba≈üvuru s√ºrecinizi dakikalar i√ßinde tamamlayƒ±n, anƒ±nda sonu√ß alƒ±n.
            </p>
            <div class="dashboard_hero_features">
                <div class="dashboard_hero_feature_item">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M10 18C14.4183 18 18 14.4183 18 10C18 5.58172 14.4183 2 10 2C5.58172 2 2 5.58172 2 10C2 14.4183 5.58172 18 10 18Z" fill="#10B981"/>
                        <path d="M7 10L9 12L13 8" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span>Hƒ±zlƒ± Onay</span>
                </div>
                <div class="dashboard_hero_feature_item">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M2 10H18M10 2V18" stroke="#0055FF" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <span>%100 ≈ûeffaf</span>
                </div>
                <div class="dashboard_hero_feature_item">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M10 2L12.09 7.26L18 8L14 12L15.18 18L10 15L4.82 18L6 12L2 8L7.91 7.26L10 2Z" fill="#F59E0B"/>
                    </svg>
                    <span>G√ºvenli ƒ∞≈ülem</span>
                </div>
            </div>
        </div>
    </section>

    <!-- ========================================================================
         S√úRE√á AKI≈ûI (12 Adƒ±mlƒ±k Workflow)
    ========================================================================= -->
    <section class="dashboard_workflow_section">
        <h2 class="dashboard_section_title">Kredi Ba≈üvuru S√ºreci</h2>
        <p class="dashboard_section_subtitle">12 basit adƒ±mda kredi ba≈üvurunuzu tamamlayƒ±n</p>
        
        <div class="dashboard_workflow_container">
            <div class="dashboard_workflow_timeline">
                @{
                    var workflowSteps = new[]
                    {
                        new { Number = 1, Title = "Kimlik Doƒürulama", Icon = "user-check", Description = "Kimlik bilgilerinizi girin" },
                        new { Number = 2, Title = "KVKK Onayƒ±", Icon = "shield-check", Description = "Gizlilik s√∂zle≈ümesini onaylayƒ±n" },
                        new { Number = 3, Title = "OTP G√∂nderimi", Icon = "message-circle", Description = "Telefonunuza kod g√∂nderilir" },
                        new { Number = 4, Title = "OTP Doƒürulama", Icon = "lock", Description = "Gelen kodu doƒürulayƒ±n" },
                        new { Number = 5, Title = "Profil Bilgileri", Icon = "user", Description = "Ki≈üisel bilgilerinizi g√ºncelleyin" },
                        new { Number = 6, Title = "Kredi Ba≈üvurusu", Icon = "file-text", Description = "Kredi t√ºr√º ve tutar se√ßin" },
                        new { Number = 7, Title = "Belge Y√ºkleme", Icon = "upload", Description = "Gerekli belgeleri y√ºkleyin" },
                        new { Number = 8, Title = "Deƒüerlendirme", Icon = "search", Description = "Ba≈üvurunuz deƒüerlendirilir" },
                        new { Number = 9, Title = "Kredi Raporu", Icon = "bar-chart", Description = "Rapor olu≈üturulur" },
                        new { Number = 10, Title = "Onay S√ºreci", Icon = "check-circle", Description = "Onay s√ºreci ba≈ülar" },
                        new { Number = 11, Title = "Sonu√ß Bildirimi", Icon = "bell", Description = "Sonu√ß size bildirilir" },
                        new { Number = 12, Title = "Para Transferi", Icon = "credit-card", Description = "Onay sonrasƒ± para transferi" }
                    };
                }
                
                @foreach (var step in workflowSteps)
                {
                    <div class="dashboard_workflow_step" data-step="@step.Number">
                        <div class="dashboard_workflow_step_connector"></div>
                        <div class="dashboard_workflow_step_card">
                            <div class="dashboard_workflow_step_icon">
                                @switch (step.Icon)
                                {
                                    case "user-check":
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
                                            <circle cx="9" cy="7" r="4"/>
                                            <path d="M22 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"/>
                                        </svg>
                                        break;
                                    case "shield-check":
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                                            <path d="M9 12l2 2 4-4" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                        break;
                                    case "message-circle":
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/>
                                        </svg>
                                        break;
                                    case "lock":
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                                            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                                        </svg>
                                        break;
                                    case "user":
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                                            <circle cx="12" cy="7" r="4"/>
                                        </svg>
                                        break;
                                    case "file-text":
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                            <path d="M14 2v6h6M16 13H8M16 17H8M10 9H8"/>
                                        </svg>
                                        break;
                                    case "upload":
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"/>
                                        </svg>
                                        break;
                                    case "search":
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <circle cx="11" cy="11" r="8"/>
                                            <path d="m21 21-4.35-4.35"/>
                                        </svg>
                                        break;
                                    case "bar-chart":
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <line x1="12" y1="20" x2="12" y2="10"/>
                                            <line x1="18" y1="20" x2="18" y2="4"/>
                                            <line x1="6" y1="20" x2="6" y2="16"/>
                                        </svg>
                                        break;
                                    case "check-circle":
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                                            <path d="M22 4L12 14.01l-3-3" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                        break;
                                    case "bell":
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9M13.73 21a2 2 0 0 1-3.46 0"/>
                                        </svg>
                                        break;
                                    case "credit-card":
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <rect x="1" y="4" width="22" height="16" rx="2" ry="2"/>
                                            <line x1="1" y1="10" x2="23" y2="10"/>
                                        </svg>
                                        break;
                                }
                            </div>
                            <div class="dashboard_workflow_step_number">@step.Number</div>
                            <h3 class="dashboard_workflow_step_title">@step.Title</h3>
                            <p class="dashboard_workflow_step_description">@step.Description</p>
                        </div>
                    </div>
                }
            </div>
        </div>
    </section>

    <!-- ========================================================================
         G√úVENLƒ∞K ROZETLERƒ∞
    ========================================================================= -->
    <section class="dashboard_security_section">
        <h2 class="dashboard_section_title">G√ºvenlik & ≈ûeffaflƒ±k</h2>
        <p class="dashboard_section_subtitle">Verileriniz en √ºst d√ºzey g√ºvenlik standartlarƒ±yla korunuyor</p>
        
        <div class="dashboard_security_badges">
            <div class="dashboard_security_badge">
                <div class="dashboard_security_badge_icon">
                    <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                        <circle cx="16" cy="16" r="16" fill="#10B981" fill-opacity="0.1"/>
                        <path d="M16 22s8-4 8-10V6l-8-3-8 3v6c0 6 8 10 8 10z" stroke="#10B981" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M12 16l3 3 6-6" stroke="#10B981" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <h3 class="dashboard_security_badge_title">Veri Maskeleme</h3>
                <p class="dashboard_security_badge_text">
                    Hassas bilgileriniz maskelenir: <strong>12*******90</strong>
                </p>
            </div>
            
            <div class="dashboard_security_badge">
                <div class="dashboard_security_badge_icon">
                    <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                        <circle cx="16" cy="16" r="16" fill="#0055FF" fill-opacity="0.1"/>
                        <path d="M16 6v6l4 2M20 20a4 4 0 1 1-8 0 4 4 0 0 1 8 0z" stroke="#0055FF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M16 8a8 8 0 1 0 0 16 8 8 0 0 0 0-16z" stroke="#0055FF" stroke-width="2"/>
                    </svg>
                </div>
                <h3 class="dashboard_security_badge_title">Decimal Hassasiyeti</h3>
                <p class="dashboard_security_badge_text">
                    T√ºm i≈ülemler <strong>2 decimal</strong> hassasiyetinde yapƒ±lƒ±r
                </p>
            </div>
            
            <div class="dashboard_security_badge">
                <div class="dashboard_security_badge_icon">
                    <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                        <circle cx="16" cy="16" r="16" fill="#F59E0B" fill-opacity="0.1"/>
                        <path d="M16 6L8 10v6c0 5.55 3.84 10.74 8 12 4.16-1.26 8-6.45 8-12v-6l-8-4z" stroke="#F59E0B" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <h3 class="dashboard_security_badge_title">SSL G√ºvenliƒüi</h3>
                <p class="dashboard_security_badge_text">
                    T√ºm veri transferleri <strong>256-bit SSL</strong> ile ≈üifrelenir
                </p>
            </div>
        </div>
    </section>

    <!-- ========================================================================
         HIZLI ERƒ∞≈ûƒ∞M KARTLARI
    ========================================================================= -->
    <section class="dashboard_quick_access_section">
        <h2 class="dashboard_section_title">Hƒ±zlƒ± Eri≈üim</h2>
        <p class="dashboard_section_subtitle">Sƒ±k kullanƒ±lan i≈ülemlerinize hƒ±zlƒ±ca eri≈üin</p>
        
        <div class="dashboard_quick_access_grid">
            <a asp-page="/Dashboard/Reports" class="dashboard_quick_access_card">
                <div class="dashboard_quick_access_card_icon">
                    <svg width="40" height="40" viewBox="0 0 40 40" fill="none">
                        <rect x="6" y="8" width="28" height="24" rx="2" fill="url(#gradient-blue)" fill-opacity="0.1"/>
                        <path d="M14 16h12M14 20h12M14 24h8" stroke="#0055FF" stroke-width="2" stroke-linecap="round"/>
                        <defs>
                            <linearGradient id="gradient-blue" x1="6" y1="8" x2="34" y2="32" gradientUnits="userSpaceOnUse">
                                <stop stop-color="#0055FF"/>
                                <stop offset="1" stop-color="#3D7EFF"/>
                            </linearGradient>
                        </defs>
                    </svg>
                </div>
                <h3 class="dashboard_quick_access_card_title">Rapor Detaylarƒ±</h3>
                <p class="dashboard_quick_access_card_description">
                    Kredi raporlarƒ±nƒ±zƒ± inceleyin ve detaylƒ± analizlere ula≈üƒ±n
                </p>
                <div class="dashboard_quick_access_card_arrow">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M7 14l6-6M13 8h-6v6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
            </a>
            
            <a asp-page="/Dashboard/Profile" class="dashboard_quick_access_card">
                <div class="dashboard_quick_access_card_icon">
                    <svg width="40" height="40" viewBox="0 0 40 40" fill="none">
                        <circle cx="20" cy="14" r="6" fill="url(#gradient-purple)" fill-opacity="0.1"/>
                        <path d="M10 32c0-5.523 4.477-10 10-10s10 4.477 10 10" stroke="#7C3AED" stroke-width="2" stroke-linecap="round"/>
                        <defs>
                            <linearGradient id="gradient-purple" x1="14" y1="8" x2="26" y2="20" gradientUnits="userSpaceOnUse">
                                <stop stop-color="#7C3AED"/>
                                <stop offset="1" stop-color="#A78BFA"/>
                            </linearGradient>
                        </defs>
                    </svg>
                </div>
                <h3 class="dashboard_quick_access_card_title">Profil Ayarlarƒ±</h3>
                <p class="dashboard_quick_access_card_description">
                    Ki≈üisel bilgilerinizi ve tercihlerinizi y√∂netin
                </p>
                <div class="dashboard_quick_access_card_arrow">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M7 14l6-6M13 8h-6v6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
            </a>
        </div>
    </section>
</div>

@section Scripts {
    <script>
        // Selector Caching
        var $workflowSteps = $('.dashboard_workflow_step');
        var $quickAccessCards = $('.dashboard_quick_access_card');
        
        // Workflow step hover effects
        $workflowSteps.on('mouseenter', function() {
            $(this).addClass('dashboard_workflow_step--active');
        }).on('mouseleave', function() {
            $(this).removeClass('dashboard_workflow_step--active');
        });
        
        // Quick access card hover effects
        $quickAccessCards.on('mouseenter', function() {
            $(this).addClass('dashboard_quick_access_card--hover');
        }).on('mouseleave', function() {
            $(this).removeClass('dashboard_quick_access_card--hover');
        });
    </script>
}
